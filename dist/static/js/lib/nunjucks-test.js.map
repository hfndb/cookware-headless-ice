{"version":3,"sources":["nunjucks-test.ts"],"names":["cfg","AppConfig","getInstance","log","Logger","options","logging","dir","dirMain","file","useConsole","html","dirs","templates","content","concat","process","env","NODE_ENV","describe","it","nj","NunjucksUtils","expected","item","getUserData","value","extends","to","equal","inclIncludes","qty","includes","length","variables","blocks","stripFoundTags","found","rawData"],"mappings":"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","sourcesContent":["import { join } from \"path\";\nimport { expect } from \"chai\";\nimport { AppConfig, Logger } from \"../lib\";\nimport { NunjucksUtils } from \"../lib/nunjucks\";\n\n// mocha -R spec --no-colors --throw-deprecation ./dist/static/js/lib/nunjucks-test.js\n\nlet cfg = AppConfig.getInstance(\"cookware-headless-ice\");\nlet log = Logger.getInstance(cfg.options.logging);\nlet dir = join(cfg.dirMain, \"content\");\nlet file = join(\"test-pages\", \"nunjucks\", \"index.html\");\nlog; // Fool compiler - unused variable\n\ncfg.options.logging.useConsole = false;\n\ncfg.options.html.dirs.templates = [\n\tjoin(cfg.options.html.dirs.content, \"test-pages/nunjucks\")\n].concat(cfg.options.html.dirs.templates);\n\nprocess.env.NODE_ENV = \"test\";\n\ndescribe(\"Reading Nunjucks file\", function() {\n\tit(\"recognize parent\", function() {\n\t\tlet nj = new NunjucksUtils();\n\t\tlet expected = \"page_en.njk\";\n\t\tlet item = nj.getUserData(dir, file);\n\t\tlet value = item.extends[1];\n\t\texpect(value).to.equal(expected, \"parent\");\n\t});\n\n\tit(\"extract includes\", function() {\n\t\tlet nj = new NunjucksUtils();\n\t\tlet expected = 1;\n\t\tlet item = nj.getUserData(dir, file, {\n\t\t\tinclIncludes: true\n\t\t});\n\t\tlet qty = item.includes.length;\n\t\texpect(qty).to.equal(expected, \"includes\");\n\t});\n\n\tit(\"extract variables\", function() {\n\t\tlet nj = new NunjucksUtils();\n\t\tlet expected = 5;\n\t\tlet item = nj.getUserData(dir, file);\n\t\tlet qty = item.variables.length;\n\t\texpect(qty).to.equal(expected, \"variables\");\n\t});\n\n\tit(\"extract blocks\", function() {\n\t\tlet nj = new NunjucksUtils();\n\t\tlet expected = 2;\n\t\tlet item = nj.getUserData(dir, file);\n\t\tlet qty = item.blocks.length;\n\t\texpect(qty).to.equal(expected, \"blocks\");\n\t});\n\n\tit(\"extract other data\", function() {\n\t\tlet nj = new NunjucksUtils();\n\t\tlet item = nj.getUserData(dir, file, {\n\t\t\tinclIncludes: true,\n\t\t\tstripFoundTags: true\n\t\t});\n\t\tlet found = item.rawData.length > 0;\n\t\texpect(found).to.equal(true, \"other data\");\n\t\t// console.log(item.rawData.trim());\n\t});\n});\n"]}