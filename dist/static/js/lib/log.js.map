{"version":3,"sources":["log.ts"],"names":["color","require","Logger","constructor","options","shutdown","opts","fileAll","fileDatabase","fileError","transports","file","active","FileUtils","mkdir","dir","getInstance","instance","console","log","error2string","err","stack","undefined","args2string","arg","retVal","forEach","row","concat","JSON","stringify","substr","length","writeConsole","level","pars","line","frmtr","Formatter","stamp","date","Date","format","repeat","lineLenght","writeFile","args","writeUdf","msg","getStackInfo","data","method","path","pos","Error","idx","stackReg","stackReg2","stacklist","split","slice","sp","exec","search","indexOf","len","pth","udf","udfLogging","debug","process","env","NODE_ENV","unshift","blue","warn","red","playSoundOn","warning","AudioUtils","playFile","info","green","sql","tmp","logDatabase","error","exitOnError","isShuttingDown","exit","separatorLine"],"mappings":"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","sourcesContent":["import { basename, dirname, join } from \"path\";\nimport { AudioUtils } from \"./audio\";\nimport { FileUtils } from \"./files\";\nimport { Formatter } from \"./utils\";\nconst color = require(\"colors/safe\");\n\ninterface PlaySound {\n\terror: boolean;\n\twarning: boolean;\n}\n\ninterface Transport {\n\tactive: boolean;\n\tdir?: string;\n\tformat: string;\n}\n\ninterface LogConfig {\n\tlogDatabase?: boolean;\n\tdir: string;\n\texitOnError: boolean;\n\tlevel: string;\n\ttransports: { [key: string]: Transport };\n\tplaySoundOn: PlaySound;\n}\n\n/**\n * Organize logging to application logfiles and possibly console\n */\nexport class Logger {\n\tprivate opts: LogConfig;\n\tprivate fileAll: string = \"\";\n\tprivate fileDatabase: string = \"\";\n\tprivate fileError: string = \"\";\n\tprivate lineLenght: number = 80; // For writeConsole() etc.\n\n\t/**\n\t * Indicating that the application is in the process of shutting down,\n\t * after logging a thrown error and throwing a fresh error to escalate.\n\t */\n\tisShuttingDown: boolean = false;\n\n\t/**\n\t * Function to be set for graceful shutdown\n\t */\n\tshutdown: Function | null;\n\n\t/**\n\t * Function for user defined logging\n\t */\n\tudfLogging: Function | null = null;\n\n\tstatic instance: Logger | null = null;\n\n\tconstructor(options: LogConfig | null) {\n\t\tthis.shutdown = null;\n\t\tif (options == null) {\n\t\t\treturn;\n\t\t}\n\t\t/**\n\t\t * For opts.level:\n\t\t *\n\t\t * npm log levels:\n\t\t * error: 0\n\t\t * warn: 1\n\t\t * info: 2\n\t\t * verbose: 3\n\t\t * debug: 4\n\t\t *\n\t\t * Log levels acoording to ./docs/configuration.md:\n\t\t * debug, error, verbose\n\t\t */\n\t\tthis.opts = options;\n\t\tthis.fileAll = \"combined.log\";\n\t\tthis.fileDatabase = \"database.log\";\n\t\tthis.fileError = \"error.log\";\n\n\t\tif (this.opts.transports.file.active) {\n\t\t\tFileUtils.mkdir(this.opts.transports.file.dir);\n\t\t}\n\t}\n\n\t/**\n\t * Singleton factory to get instance\n\t */\n\tstatic getInstance(options?: LogConfig): Logger {\n\t\tif (!Logger.instance) {\n\t\t\tLogger.instance = new Logger(options || null);\n\t\t\tif (!options) {\n\t\t\t\tconsole.log(\"Programming error? Logger.getInstance() called without options\");\n\t\t\t}\n\t\t}\n\n\t\treturn Logger.instance;\n\t}\n\n\tstatic error2string(err: Error): string {\n\t\treturn err.stack == undefined ? \"\" : err.stack;\n\t\t// err.message.concat(\"\\n\").concat(err.name).concat(\"\\n\").concat(\n\t}\n\n\tstatic args2string(arg: any[]): string {\n\t\tlet retVal = \"\";\n\t\targ.forEach((row: string) => {\n\t\t\tif (typeof row == \"object\") {\n\t\t\t\tretVal = retVal.concat(JSON.stringify(row, null, 4)).concat(\"\\n\"); //@@\n\t\t\t} else {\n\t\t\t\tretVal = retVal.concat(row).concat(\"\\n\");\n\t\t\t}\n\t\t});\n\t\treturn retVal.substr(0, retVal.length - 1);\n\t}\n\n\tprivate writeConsole(level: string, pars: string, line = false) {\n\t\tif (!this.opts.transports.console.active) return;\n\t\tconst frmtr = Formatter.getInstance();\n\t\tlet stamp = frmtr.date(new Date(), this.opts.transports.console.format);\n\t\tif (line) {\n\t\t\tconsole.log(\"-\".repeat(this.lineLenght));\n\t\t} else {\n\t\t\tconsole.log(stamp, level, pars);\n\t\t}\n\t}\n\n\tprivate writeFile(file: string, level: string, args: string, line = false): void {\n\t\tthis.writeUdf(level, args);\n\n\t\tif (!this.opts.transports.file.active) return;\n\n\t\tconst frmtr = Formatter.getInstance();\n\t\tlet stamp = frmtr.date(new Date(), this.opts.transports.file.format);\n\t\tlet msg = line ? \"-\".repeat(this.lineLenght) : `${stamp} ${level} ${args}`;\n\n\t\tFileUtils.writeFile(\"\", join(this.opts.transports.file.dir, file), msg, false, \"a\");\n\t}\n\n\tprivate getStackInfo(): object {\n\t\t// Stack trace format :\n\t\t// https://github.com/v8/v8/wiki/Stack%20Trace%20API\n\t\tlet data = {\n\t\t\tmethod: \"\",\n\t\t\tpath: \"\",\n\t\t\tline: \"\",\n\t\t\tpos: \"\",\n\t\t\tdir: \"\",\n\t\t\tfile: \"\",\n\t\t\tstack: [\n\t\t\t\t\"\"\n\t\t\t]\n\t\t};\n\t\tlet err = new Error(\"\");\n\t\tlet idx = 1;\n\t\tlet stackReg = /at\\s+(.*)\\s+\\((.*):(\\d*):(\\d*)\\)/i;\n\t\tlet stackReg2 = /at\\s+()(.*):(\\d*):(\\d*)/i;\n\t\tlet stacklist = (err.stack || \"\").split(\"\\n\").slice(2);\n\t\tlet sp = stackReg.exec(stacklist[idx]) || stackReg2.exec(stacklist[idx]);\n\t\tif (sp && sp.length === 5) {\n\t\t\tdata.method = sp[1];\n\t\t\tdata.path = sp[2];\n\t\t\tdata.line = sp[3];\n\t\t\tdata.pos = sp[4];\n\t\t\tdata.stack = stacklist;\n\n\t\t\t[\n\t\t\t\t\"dist/src\",\n\t\t\t\t\"static/js\"\n\t\t\t].forEach((search) => {\n\t\t\t\tlet idx = data.path.indexOf(search);\n\t\t\t\tlet len = search.length;\n\t\t\t\tif (idx >= 0) {\n\t\t\t\t\tlet pth = data.path.substr(idx + len + 1);\n\t\t\t\t\tdata.dir = dirname(pth);\n\t\t\t\t\tdata.file = basename(pth);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn data;\n\t}\n\n\t/**\n\t * Method to write to another transport, user defined\n\t */\n\tpublic writeUdf(level: string, args: string): boolean {\n\t\tif (!this.opts.transports.udf || !this.udfLogging) return false;\n\t\treturn this.udfLogging(level, args);\n\t}\n\n\tpublic debug(...args: any[]): void {\n\t\tif (process.env.NODE_ENV == \"production\" || process.env.NODE_ENV == \"test\") {\n\t\t\treturn;\n\t\t}\n\t\tlet stack: any = this.getStackInfo();\n\t\targs.unshift(`  [ ${stack.dir}/${stack.file}:${stack.line}:${stack.pos}, ${stack.method} ]`);\n\t\tlet pars = Logger.args2string(args);\n\t\tthis.writeConsole(color.blue(\"Debug\"), pars);\n\t\tthis.writeFile(this.fileAll, \"debug\", pars + \"\\n\");\n\t}\n\n\tpublic warn(...args: any[]): void {\n\t\tlet pars = Logger.args2string(args);\n\t\tthis.writeConsole(color.red(\"Warn \"), pars);\n\t\tthis.writeFile(this.fileAll, \"warning\", pars + \"\\n\");\n\t\tif (this.opts.playSoundOn.warning) {\n\t\t\t// Taken from https://www.soundjay.com/\n\t\t\tAudioUtils.playFile(join(\"bin\", \"writing-signature-1.mp3\"));\n\t\t}\n\t}\n\n\tpublic info(...args: any[]): void {\n\t\tlet pars = Logger.args2string(args);\n\t\tthis.writeConsole(color.green(\"Info \"), pars);\n\t\tthis.writeFile(this.fileAll, \"info\", pars + \"\\n\");\n\t}\n\n\tpublic sql(...args: any[]): void {\n\t\tlet tmp = this.opts.logDatabase;\n\t\tif (!tmp) return;\n\t\tlet pars = Logger.args2string(args);\n\t\tthis.writeConsole(color.green(\"Info \"), pars);\n\t\tthis.opts.logDatabase = false;\n\t\tthis.writeFile(this.fileDatabase, \"\", pars + \"\\n\");\n\t\tthis.opts.logDatabase = tmp;\n\t}\n\n\tpublic error(...args: any[]): void {\n\t\tlet pars = Logger.args2string(args);\n\t\tthis.writeConsole(color.red(\"Error\"), pars);\n\t\tthis.writeFile(this.fileError, \"error\", pars + \"\\n\");\n\t\tif (this.opts.playSoundOn.error) {\n\t\t\t// Taken from https://www.soundjay.com/\n\t\t\tAudioUtils.playFile(join(\"bin\", \"writing-signature-1.mp3\"));\n\t\t}\n\t\tif (this.opts.exitOnError) {\n\t\t\tthis.isShuttingDown = true;\n\t\t\tif (this.shutdown == null) {\n\t\t\t\tthrow new Error();\n\t\t\t} else {\n\t\t\t\tthis.shutdown(); // Graceful shutdown\n\t\t\t}\n\t\t\tprocess.exit(-1);\n\t\t}\n\t}\n\n\t/**\n\t * Write a line to separate groups of log entries\n\t */\n\tpublic separatorLine() {\n\t\tthis.writeConsole(null, null, true);\n\t\tthis.writeFile(this.fileAll, null, null, true);\n\t}\n}\n"]}