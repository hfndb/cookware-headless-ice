{"version":3,"sources":["upgrades.ts"],"names":["upgrade","cfg","system","dir","dirMain","dirProject","needsUpdate","options","FileUtils","readJsonFile","versionTarget","versionCurrent","Object","getOwnPropertyDescriptor","value","console","error"],"mappings":";;;;;;;;;AAAA;;AACA;;AAUO,SAASA,OAAT,CAAiBC,GAAjB,EAAiCC,MAAe,GAAG,KAAnD,EAAmE;AACzE,MAAIC,GAAG,GAAGD,MAAM,GAAGD,GAAG,CAACG,OAAP,GAAiBH,GAAG,CAACI,UAArC;AACA,MAAIC,WAAW,GAAG,KAAlB;;AACA,MAAIC,OAAO,GAAGC,eAAUC,YAAV,CAAuB,gBAAKN,GAAL,EAAU,aAAV,CAAvB,CAAd;;AACA,MAAIO,aAAa,GAAG,OAApB;AACA,MAAIC,cAAc,GAAGC,MAAM,CAACC,wBAAP,CAAgCN,OAAhC,EAAyC,SAAzC,CAArB;;AACA,MAAII,cAAJ,EAAoB;AACnBA,IAAAA,cAAc,GAAGA,cAAc,CAACG,KAAhC;AACA,GAFD,MAEO;AACNC,IAAAA,OAAO,CAACC,KAAR,CAAc,sEAAd;AACA,WAAO,KAAP;AACA;;AAED,MAAIL,cAAc,IAAID,aAAtB,EAAqC;AACpC,WAAO,IAAP;AACA,GAFD,MAEO;AACNJ,IAAAA,WAAW,GAAG,IAAd;AACA;;AAIDA,EAAAA,WAAW;AAIX,SAAO,IAAP;AACA","sourcesContent":["import { join } from \"path\";\nimport { FileUtils } from \"../lib\";\nimport { AppConfig } from \"../lib/config\";\n\n/**\n * @todo Perhaps this file is obsolte, unless config.json will need specal conversions in the future\n */\n\n/**\n * Perform upgrade to a newer version of the config file\n */\nexport function upgrade(cfg: AppConfig, system: boolean = false): boolean {\n\tlet dir = system ? cfg.dirMain : cfg.dirProject;\n\tlet needsUpdate = false;\n\tlet options = FileUtils.readJsonFile(join(dir, \"config.json\"));\n\tlet versionTarget = \"0.0.1\";\n\tlet versionCurrent = Object.getOwnPropertyDescriptor(options, \"version\");\n\tif (versionCurrent) {\n\t\tversionCurrent = versionCurrent.value;\n\t} else {\n\t\tconsole.error(\"Couldn't find a version number in config.json. Exiting now... bye!\\n\");\n\t\treturn false;\n\t}\n\n\tif (versionCurrent == versionTarget) {\n\t\treturn true;\n\t} else {\n\t\tneedsUpdate = true;\n\t}\n\n\t// For future usage: Perform some magic here...\n\n\tneedsUpdate; // Fool compiler - unused variable\n\n\t// If (system and needs update) then replace config-org.json and default-project/config-org.json\n\n\treturn true;\n}\n"]}